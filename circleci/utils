#!/bin/bash

# Common functions used by more than on ci-script
#
# Usage:
#
#   . ./utils

set -e

install_awscli(){
  if type aws > /dev/null; then
    echo "AWS cli already installed"
    return
  fi

  echo "Installing AWS cli..."
  rm -rf ~/.local
  
  # Download the versioned pip installer which works with Python 2.7 (https://github.com/pypa/pip/issues/9500)
  # TODO: Replace in favor of installing AWS CLI v2 directly
  wget --directory-prefix=/tmp/ https://bootstrap.pypa.io/2.7/get-pip.py
  sudo python /tmp/get-pip.py

  sudo apt-get update
  sudo apt-get install python-dev
  sudo pip install --upgrade awscli && aws --version

  pip install --upgrade --user awscli
  echo "Completed AWS cli install"
}
